{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { BaseNode, interval } from 'kapellmeister';\nimport mergeKeys from '../core/mergeKeys';\nimport { ENTER, UPDATE, LEAVE } from '../core/types';\nimport { numeric } from '../utils';\n\nvar NodeGroup = function (_Component) {\n  _inherits(NodeGroup, _Component);\n\n  function NodeGroup(props) {\n    var _this;\n\n    _classCallCheck(this, NodeGroup);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(NodeGroup).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"animate\", function () {\n      var _this$state = _this.state,\n          nodeKeys = _this$state.nodeKeys,\n          nodeHash = _this$state.nodeHash;\n\n      if (_this.unmounting) {\n        return;\n      }\n\n      var pending = false;\n      var nextNodeKeys = [];\n      var length = nodeKeys.length;\n\n      for (var i = 0; i < length; i++) {\n        var k = nodeKeys[i];\n        var n = nodeHash[k];\n        var isTransitioning = n.isTransitioning();\n\n        if (isTransitioning) {\n          pending = true;\n        }\n\n        if (n.type === LEAVE && !isTransitioning) {\n          delete nodeHash[k];\n        } else {\n          nextNodeKeys.push(k);\n        }\n      }\n\n      if (!pending) {\n        _this.interval.stop();\n      }\n\n      _this.setState(function () {\n        return {\n          nodeKeys: nextNodeKeys,\n          nodes: nextNodeKeys.map(function (key) {\n            return nodeHash[key];\n          })\n        };\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"interval\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"unmounting\", false);\n\n    var interpolation = props.interpolation;\n\n    var Node = function (_BaseNode) {\n      _inherits(Node, _BaseNode);\n\n      function Node(key, data) {\n        var _this2;\n\n        _classCallCheck(this, Node);\n\n        _this2 = _possibleConstructorReturn(this, _getPrototypeOf(Node).call(this));\n\n        _defineProperty(_assertThisInitialized(_this2), \"getInterpolator\", interpolation);\n\n        _this2.key = key;\n        _this2.data = data;\n        _this2.type = ENTER;\n        return _this2;\n      }\n\n      return Node;\n    }(BaseNode);\n\n    _this.state = {\n      Node: Node,\n      nodeKeys: [],\n      nodeHash: {},\n      nodes: [],\n      data: null\n    };\n    return _this;\n  }\n\n  _createClass(NodeGroup, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.startInterval();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (prevProps.data !== this.props.data && !this.unmounting) {\n        this.startInterval();\n      }\n    }\n  }, {\n    key: \"startInterval\",\n    value: function startInterval() {\n      if (!this.interval) {\n        this.interval = interval(this.animate);\n      } else {\n        this.interval.restart(this.animate);\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var _this$state2 = this.state,\n          nodeKeys = _this$state2.nodeKeys,\n          nodeHash = _this$state2.nodeHash;\n      this.unmounting = true;\n\n      if (this.interval) {\n        this.interval.stop();\n      }\n\n      nodeKeys.forEach(function (key) {\n        nodeHash[key].stopTransitions();\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var renderedChildren = this.props.children(this.state.nodes);\n      return renderedChildren && React.Children.only(renderedChildren);\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(nextProps, prevState) {\n      if (nextProps.data !== prevState.data) {\n        var data = nextProps.data,\n            keyAccessor = nextProps.keyAccessor,\n            start = nextProps.start,\n            enter = nextProps.enter,\n            update = nextProps.update,\n            leave = nextProps.leave;\n        var Node = prevState.Node,\n            nodeKeys = prevState.nodeKeys,\n            nodeHash = prevState.nodeHash;\n        var keyIndex = {};\n\n        for (var i = 0; i < nodeKeys.length; i++) {\n          keyIndex[nodeKeys[i]] = i;\n        }\n\n        var nextKeyIndex = {};\n        var nextNodeKeys = [];\n\n        for (var _i = 0; _i < data.length; _i++) {\n          var d = data[_i];\n          var k = keyAccessor(d, _i);\n          nextKeyIndex[k] = _i;\n          nextNodeKeys.push(k);\n\n          if (keyIndex[k] === undefined) {\n            var node = new Node();\n            node.key = k;\n            node.data = d;\n            node.type = ENTER;\n            nodeHash[k] = node;\n          }\n        }\n\n        for (var _i2 = 0; _i2 < nodeKeys.length; _i2++) {\n          var _k = nodeKeys[_i2];\n          var n = nodeHash[_k];\n\n          if (nextKeyIndex[_k] !== undefined) {\n            n.data = data[nextKeyIndex[_k]];\n            n.type = UPDATE;\n          } else {\n            n.type = LEAVE;\n          }\n        }\n\n        var mergedNodeKeys = mergeKeys(nodeKeys, keyIndex, nextNodeKeys, nextKeyIndex);\n\n        for (var _i3 = 0; _i3 < mergedNodeKeys.length; _i3++) {\n          var _k2 = mergedNodeKeys[_i3];\n          var _n = nodeHash[_k2];\n          var _d = _n.data;\n\n          if (_n.type === ENTER) {\n            _n.setState(start(_d, nextKeyIndex[_k2]));\n\n            _n.transition(enter(_d, nextKeyIndex[_k2]));\n          } else if (_n.type === LEAVE) {\n            _n.transition(leave(_d, keyIndex[_k2]));\n          } else {\n            _n.transition(update(_d, nextKeyIndex[_k2]));\n          }\n        }\n\n        return {\n          data: data,\n          nodes: mergedNodeKeys.map(function (key) {\n            return nodeHash[key];\n          }),\n          nodeHash: nodeHash,\n          nodeKeys: mergedNodeKeys\n        };\n      }\n\n      return null;\n    }\n  }]);\n\n  return NodeGroup;\n}(Component);\n\nNodeGroup.propTypes = process.env.NODE_ENV !== \"production\" ? {\n  data: PropTypes.array.isRequired,\n  keyAccessor: PropTypes.func.isRequired,\n  interpolation: PropTypes.func,\n  start: PropTypes.func.isRequired,\n  enter: PropTypes.func,\n  update: PropTypes.func,\n  leave: PropTypes.func,\n  children: PropTypes.func.isRequired\n} : {};\nNodeGroup.defaultProps = {\n  enter: function enter() {},\n  update: function update() {},\n  leave: function leave() {},\n  interpolation: numeric\n};\nexport default NodeGroup;","map":{"version":3,"sources":["/Users/wonjiky/Desktop/pac-digitalstories/node_modules/react-move/es/NodeGroup/index.js"],"names":["_classCallCheck","_createClass","_possibleConstructorReturn","_getPrototypeOf","_assertThisInitialized","_inherits","_defineProperty","React","Component","PropTypes","BaseNode","interval","mergeKeys","ENTER","UPDATE","LEAVE","numeric","NodeGroup","_Component","props","_this","call","_this$state","state","nodeKeys","nodeHash","unmounting","pending","nextNodeKeys","length","i","k","n","isTransitioning","type","push","stop","setState","nodes","map","key","interpolation","Node","_BaseNode","data","_this2","value","componentDidMount","startInterval","componentDidUpdate","prevProps","animate","restart","componentWillUnmount","_this$state2","forEach","stopTransitions","render","renderedChildren","children","Children","only","getDerivedStateFromProps","nextProps","prevState","keyAccessor","start","enter","update","leave","keyIndex","nextKeyIndex","_i","d","undefined","node","_i2","_k","mergedNodeKeys","_i3","_k2","_n","_d","transition","propTypes","process","env","NODE_ENV","array","isRequired","func","defaultProps"],"mappings":"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","sourcesContent":["import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { BaseNode, interval } from 'kapellmeister';\nimport mergeKeys from '../core/mergeKeys';\nimport { ENTER, UPDATE, LEAVE } from '../core/types';\nimport { numeric } from '../utils';\n\nvar NodeGroup = function (_Component) {\n  _inherits(NodeGroup, _Component);\n\n  function NodeGroup(props) {\n    var _this;\n\n    _classCallCheck(this, NodeGroup);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(NodeGroup).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"animate\", function () {\n      var _this$state = _this.state,\n          nodeKeys = _this$state.nodeKeys,\n          nodeHash = _this$state.nodeHash;\n\n      if (_this.unmounting) {\n        return;\n      }\n\n      var pending = false;\n      var nextNodeKeys = [];\n      var length = nodeKeys.length;\n\n      for (var i = 0; i < length; i++) {\n        var k = nodeKeys[i];\n        var n = nodeHash[k];\n        var isTransitioning = n.isTransitioning();\n\n        if (isTransitioning) {\n          pending = true;\n        }\n\n        if (n.type === LEAVE && !isTransitioning) {\n          delete nodeHash[k];\n        } else {\n          nextNodeKeys.push(k);\n        }\n      }\n\n      if (!pending) {\n        _this.interval.stop();\n      }\n\n      _this.setState(function () {\n        return {\n          nodeKeys: nextNodeKeys,\n          nodes: nextNodeKeys.map(function (key) {\n            return nodeHash[key];\n          })\n        };\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"interval\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"unmounting\", false);\n\n    var interpolation = props.interpolation;\n\n    var Node = function (_BaseNode) {\n      _inherits(Node, _BaseNode);\n\n      function Node(key, data) {\n        var _this2;\n\n        _classCallCheck(this, Node);\n\n        _this2 = _possibleConstructorReturn(this, _getPrototypeOf(Node).call(this));\n\n        _defineProperty(_assertThisInitialized(_this2), \"getInterpolator\", interpolation);\n\n        _this2.key = key;\n        _this2.data = data;\n        _this2.type = ENTER;\n        return _this2;\n      }\n\n      return Node;\n    }(BaseNode);\n\n    _this.state = {\n      Node: Node,\n      nodeKeys: [],\n      nodeHash: {},\n      nodes: [],\n      data: null\n    };\n    return _this;\n  }\n\n  _createClass(NodeGroup, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.startInterval();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (prevProps.data !== this.props.data && !this.unmounting) {\n        this.startInterval();\n      }\n    }\n  }, {\n    key: \"startInterval\",\n    value: function startInterval() {\n      if (!this.interval) {\n        this.interval = interval(this.animate);\n      } else {\n        this.interval.restart(this.animate);\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var _this$state2 = this.state,\n          nodeKeys = _this$state2.nodeKeys,\n          nodeHash = _this$state2.nodeHash;\n      this.unmounting = true;\n\n      if (this.interval) {\n        this.interval.stop();\n      }\n\n      nodeKeys.forEach(function (key) {\n        nodeHash[key].stopTransitions();\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var renderedChildren = this.props.children(this.state.nodes);\n      return renderedChildren && React.Children.only(renderedChildren);\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(nextProps, prevState) {\n      if (nextProps.data !== prevState.data) {\n        var data = nextProps.data,\n            keyAccessor = nextProps.keyAccessor,\n            start = nextProps.start,\n            enter = nextProps.enter,\n            update = nextProps.update,\n            leave = nextProps.leave;\n        var Node = prevState.Node,\n            nodeKeys = prevState.nodeKeys,\n            nodeHash = prevState.nodeHash;\n        var keyIndex = {};\n\n        for (var i = 0; i < nodeKeys.length; i++) {\n          keyIndex[nodeKeys[i]] = i;\n        }\n\n        var nextKeyIndex = {};\n        var nextNodeKeys = [];\n\n        for (var _i = 0; _i < data.length; _i++) {\n          var d = data[_i];\n          var k = keyAccessor(d, _i);\n          nextKeyIndex[k] = _i;\n          nextNodeKeys.push(k);\n\n          if (keyIndex[k] === undefined) {\n            var node = new Node();\n            node.key = k;\n            node.data = d;\n            node.type = ENTER;\n            nodeHash[k] = node;\n          }\n        }\n\n        for (var _i2 = 0; _i2 < nodeKeys.length; _i2++) {\n          var _k = nodeKeys[_i2];\n          var n = nodeHash[_k];\n\n          if (nextKeyIndex[_k] !== undefined) {\n            n.data = data[nextKeyIndex[_k]];\n            n.type = UPDATE;\n          } else {\n            n.type = LEAVE;\n          }\n        }\n\n        var mergedNodeKeys = mergeKeys(nodeKeys, keyIndex, nextNodeKeys, nextKeyIndex);\n\n        for (var _i3 = 0; _i3 < mergedNodeKeys.length; _i3++) {\n          var _k2 = mergedNodeKeys[_i3];\n          var _n = nodeHash[_k2];\n          var _d = _n.data;\n\n          if (_n.type === ENTER) {\n            _n.setState(start(_d, nextKeyIndex[_k2]));\n\n            _n.transition(enter(_d, nextKeyIndex[_k2]));\n          } else if (_n.type === LEAVE) {\n            _n.transition(leave(_d, keyIndex[_k2]));\n          } else {\n            _n.transition(update(_d, nextKeyIndex[_k2]));\n          }\n        }\n\n        return {\n          data: data,\n          nodes: mergedNodeKeys.map(function (key) {\n            return nodeHash[key];\n          }),\n          nodeHash: nodeHash,\n          nodeKeys: mergedNodeKeys\n        };\n      }\n\n      return null;\n    }\n  }]);\n\n  return NodeGroup;\n}(Component);\n\nNodeGroup.propTypes = process.env.NODE_ENV !== \"production\" ? {\n  data: PropTypes.array.isRequired,\n  keyAccessor: PropTypes.func.isRequired,\n  interpolation: PropTypes.func,\n  start: PropTypes.func.isRequired,\n  enter: PropTypes.func,\n  update: PropTypes.func,\n  leave: PropTypes.func,\n  children: PropTypes.func.isRequired\n} : {};\nNodeGroup.defaultProps = {\n  enter: function enter() {},\n  update: function update() {},\n  leave: function leave() {},\n  interpolation: numeric\n};\nexport default NodeGroup;"]},"metadata":{},"sourceType":"module"}